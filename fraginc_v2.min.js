const fragAddress="TBrPXHrTjiFEwE1YsV7w76wQQ9DnqhiZz9",contractAddress="TFXExJdAGBRzkjv5nMGfT8j8A7PDpHZtFV";let myaddress,refferal,contractInstance,fragInstance,totalFee1=0,totalFee2=0,totalFee3=0,totalFee4=0,sellPriceWithfees=[],loaded=!1;function roundToFour(a){return+(Math.floor(a+"e+4")+"e-4")}function roundToTwo(a){return+(Math.floor(a+"e+2")+"e-2")}function round(a){return+(Math.floor(a+"e+0")+"e-0")}const accountInterval2=setInterval(async function(){myaddress==tronWeb.defaultAddress.base58?contractInstance===void 0?(contractInstance=await tronWeb.contract().at(contractAddress),fragInstance=await tronWeb.contract().at(fragAddress),refferal=getUrlVars().ref||tronWeb.defaultAddress.base58,console.log(refferal)):(putvalues(),!loaded&&loadOneTime()):(!1==myaddress&&!1!=tronWeb.defaultAddress.base58&&location.reload(),myaddress=tronWeb.defaultAddress.base58)},3e3);async function putvalues(){const[a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v]=await Promise.all([contractInstance.unclaimed(myaddress).call(),contractInstance.getPlayerUnitsById(0,myaddress).call(),contractInstance.getPlayerUnitsById(1,myaddress).call(),contractInstance.getPlayerUnitsById(2,myaddress).call(),contractInstance.getPlayerUnitsById(3,myaddress).call(),contractInstance.getUnitSharesById(0).call(),contractInstance.getUnitSharesById(1).call(),contractInstance.getUnitSharesById(2).call(),contractInstance.getUnitSharesById(3).call(),contractInstance.getUnitCookiesPerSecond(0).call(),contractInstance.getUnitCookiesPerSecond(1).call(),contractInstance.getUnitCookiesPerSecond(2).call(),contractInstance.getUnitCookiesPerSecond(3).call(),contractInstance.getUnitPrice(0).call(),contractInstance.getUnitPrice(1).call(),contractInstance.getUnitPrice(2).call(),contractInstance.getUnitPrice(3).call(),contractInstance.getCookiePot().call(),contractInstance.getProducedCookiesForPlayer(tronWeb.defaultAddress.base58).call(),contractInstance.calculateCookieValueForPlayer().call(),fragInstance.balanceOf(tronWeb.defaultAddress.base58).call(),fragInstance.balanceOf(contractAddress).call()]);document.getElementById("WithdrawbleFrag").innerHTML=a/1e18,document.getElementById("YourUnits1").innerHTML=b,document.getElementById("YourUnits2").innerHTML=c,document.getElementById("YourUnits3").innerHTML=d,document.getElementById("YourUnits4").innerHTML=e,document.getElementById("ProdUnit1top").innerHTML=j*b,document.getElementById("ProdUnit2top").innerHTML=k*c,document.getElementById("ProdUnit3top").innerHTML=l*d,document.getElementById("ProdUnit4top").innerHTML=m*e,document.getElementById("YourShare1").innerHTML=f*b,document.getElementById("YourShare2").innerHTML=g*c,document.getElementById("YourShare3").innerHTML=h*d,document.getElementById("YourShare4").innerHTML=i*e,document.getElementById("BuyPriceUnit1").innerHTML=n/1e18,document.getElementById("BuyPriceUnit2").innerHTML=o/1e18,document.getElementById("BuyPriceUnit3").innerHTML=p/1e18,document.getElementById("BuyPriceUnit4").innerHTML=q/1e18,document.getElementById("FragBalance").innerHTML=roundToTwo(u/1e18),document.getElementById("cookiePot").innerHTML=roundToTwo(r/1e18),document.getElementById("your_cookies").innerHTML=roundToTwo(s),document.getElementById("cookies_value").innerHTML=roundToTwo(t/1e18),document.getElementById("contract_pot").innerHTML=roundToTwo(v/1e18),document.getElementById("your_addy").innerHTML=myaddress.substring(0,3)+"..."+myaddress.substring(myaddress.length-4,myaddress.length),document.getElementById("your_prod").innerHTML=j*b+k*c+l*d+m*e,document.getElementById("your_shares").innerHTML=f*b+g*c+h*d+i*e,sellPriceWithfees[0]=(100-totalFee1)/100*n/1e18,sellPriceWithfees[1]=(100-totalFee2)/100*o/1e18,sellPriceWithfees[2]=(100-totalFee3)/100*p/1e18,sellPriceWithfees[3]=(100-totalFee4)/100*q/1e18}async function loadOneTime(){const[a,b,c,d,e,f,g,h,i,j,k,l]=await Promise.all([contractInstance.getUnitSellFee(0).call(),contractInstance.getUnitSellFee(1).call(),contractInstance.getUnitSellFee(2).call(),contractInstance.getUnitSellFee(3).call(),contractInstance.getUnitBuyFee(0).call(),contractInstance.getUnitBuyFee(1).call(),contractInstance.getUnitBuyFee(2).call(),contractInstance.getUnitBuyFee(3).call(),isUnitUnlocked(0),isUnitUnlocked(1),isUnitUnlocked(2),isUnitUnlocked(3)]);totalFee1=+a+ +e,totalFee2=+b+ +f,totalFee3=+c+ +g,totalFee4=+d+ +h,document.getElementById("sellFee1").innerHTML=a,document.getElementById("sellFee2").innerHTML=b,document.getElementById("sellFee3").innerHTML=c,document.getElementById("sellFee4").innerHTML=d,document.getElementById("buyFee1").innerHTML=e,document.getElementById("buyFee2").innerHTML=f,document.getElementById("buyFee3").innerHTML=g,document.getElementById("buyFee4").innerHTML=h,i&&$("#isLocked1").hide(),j&&$("#isLocked2").hide(),k&&$("#isLocked3").hide(),l&&$("#isLocked4").hide(),loaded=!0}async function withdraw(){contractInstance.withdrawGains().send({callValue:0,shouldPollResponse:!0})}async function sellcookies(){contractInstance.sellCookies().send({callValue:0,shouldPollResponse:!0})}async function buyUnits(a,b,c){const d=tronWeb.address.toHex(c).substring(2);await fragInstance.approveAndCall("TFXExJdAGBRzkjv5nMGfT8j8A7PDpHZtFV",tronWeb.toHex(1e18*b),`0x00000000000000000000000000000000000000000000000000000000000000${a}000000000000000000000000${d}`).send()}async function sellUnits(a,b,c){await contractInstance.sellUnits(a,b,c).send({shouldPollResponse:!1,callValue:0})}async function isUnitUnlocked(a){const b=await contractInstance.isUnitUnlocked(a).call();return b}async function getReff(){const a=tronWeb.defaultAddress.base58,b=window.location.protocol+"//"+window.location.host+"/?ref=";copyToClipboard(b+a),alert("Refferal link copied")}function copyToClipboard(a){if(window.clipboardData&&window.clipboardData.setData)return clipboardData.setData("Text",a);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){var b=document.createElement("textarea");b.textContent=a,b.style.position="fixed",document.body.appendChild(b),b.select();try{return document.execCommand("copy")}catch(a){return console.warn("Copy to clipboard failed.",a),!1}finally{document.body.removeChild(b)}}}function getUrlVars(){var a={},b=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(b,c,d){a[c]=d});return a}$(document).ready(function(){console.log("loaded"),$(".buyUnitField").each(function(a){var b=$(this);b.data("oldVal",b.val()),b.bind("propertychange change click keyup input paste",function(){b.data("oldVal")!=b.val()&&(b.data("oldVal",b.val()),updateBuyFields(b.val(),a),console.log(b.val(),a))})}),$(".sellUnitField").each(function(a){var b=$(this);b.data("oldVal",b.val()),b.bind("propertychange change click keyup input paste",function(){b.data("oldVal")!=b.val()&&(b.data("oldVal",b.val()),updateSellFields(b.val(),a),console.log(b.val(),a))})}),$("#Buy1").click(function(){const a=document.getElementById("BuyUnit1").value;buyUnits(0,a,refferal)}),$("#Buy2").click(function(){const a=document.getElementById("BuyUnit2").value;buyUnits(1,a,refferal)}),$("#Buy3").click(function(){const a=document.getElementById("BuyUnit3").value;buyUnits(2,a,refferal)}),$("#Buy4").click(function(){const a=document.getElementById("BuyUnit4").value;buyUnits(3,a,refferal)}),$("#Sell1").click(function(){const a=document.getElementById("SellUnit1").value;sellUnits(0,a,refferal)}),$("#Sell2").click(function(){const a=document.getElementById("SellUnit2").value;sellUnits(1,a,refferal)}),$("#Sell3").click(function(){const a=document.getElementById("SellUnit3").value;sellUnits(2,a,refferal)}),$("#Sell4").click(function(){const a=document.getElementById("SellUnit4").value;sellUnits(3,a,refferal)})});function updateBuyFields(a,b){const c=b+1,d=document.getElementById("BuyPriceUnit"+c).innerHTML;document.getElementById("BuyUnit"+c+"Recive").innerHTML=round(a/d)}async function updateSellFields(a,b){const c=sellPriceWithfees[b]*a;document.getElementById("SellFragRecive"+(b+1)).innerHTML=roundToTwo(c)}
